<script type="text/javascript">
  var myCanvas;
  var tennisCourt;
  var gameover = false;
  var winScore = 5;
  var loseScore = -5;
  

  var tennisBall_radius = 50;

  offsetRacket_w = 200;
  offsetRacket_h = 300;
  tennisRacket_w = 65;
  tennisRacket_h = 148;

  var ball = new TennisBall () ;
  var tennisRacket = new TennisRacket();

  var score = 0;

  function TennisCourt() {

    var tcObj = this;
    tcObj.objects = [];

    myCanvas = document.getElementById("tennis-court");
    tennisCourt =myCanvas.getContext("2d");

    resizeCanvas();

    window.onresize = function () {
	resizeCanvas();
    }

   function resizeCanvas() {
	myCanvas.width = window.innerWidth;
	myCanvas.height = window.innerHeight-300;

	tennisRacket.x = myCanvas.width - offsetRacket_w;
	tennisRacket.y = myCanvas.height - offsetRacket_h;
    }

    var img = new Image();
    img.src = "tennis court.png";
    img.onload = function () {
	tcObj.tennisCourtImage = img;
	tcObj.doDraw = true;
    }
 
    tcObj.doDraw = true;

    function draw() {
	drawTennisCourt();
	drawObjects();
	tcObj.doDraw=false;
    }

    function drawTennisCourt() {
	if (tcObj.tennisCourtImage) {
	   tennisCourt.drawImage(tcObj.tennisCourtImage, 0, 0, myCanvas.width, myCanvas.height);
	}
    }

    function drawObjects() {
	for (var i = 0; i < tcObj.objects.length; i++) {
	   tcObj.objects[i].draw(tennisCourt);
	}
    }

    tcObj.addObject = function (obj) {
	tcObj.objects.push(obj);
    }

    tcObj.init = function () {
	setInterval(function () { draw(); }, 40);
    };
  
  }

  function TennisRacket () {
    var racketObj = this;
    racketObj.x = 800;
    racketObj.y = 400;

    var img = new Image();
    img.src = "tennis-racket.png";
    img.onload = function () {
	racketObj.img = img;
    }

    racketObj.draw = function (context) {
	if (racketObj.img) {
	   context.drawImage(racketObj.img, racketObj.x, racketObj.y, tennisRacket_w, tennisRacket_h);
	}
    }
  }



  function TennisBall () {
    var ballObj = this;
    ballObj.speed = 10;
    ballObj.x = 0;
    ballObj.y = 0;
    ballObj.dx = 1;
    ballObj.dy = 1;

    myCanvas = document.getElementById ("tennis-court");

    var img = new Image();
    img.src = "tennis-ball.png";
    img.onload = function () {
	ballObj.img = img;
    }

    ballObj.move = function () {
	var ball = ballObj;

	if (!gameover) {
	  
	  if( checkCollision(tennisRacket.x, tennisRacket.y, tennisRacket_w, tennisRacket_h,
			ball.x, ball.y, tennisBall_radius) ) {
		this.dx *= -1;
		this.dy *= -1;
	}

	if( ballObj.x <= 0 || ballObj.x >= myCanvas.width-50 ) {
	   ballObj.dx *= -1;
	}
	
	if( ballObj.y <= 0 || ballObj.y >= myCanvas.height-50 ) {
	   ballObj.dy *= -1;
	}
	
	if( ballObj.x <= 0 ) {
	    addPoint();
        }

	if( ballObj.x >= myCanvas.width-50) {
	    losePoint();
	  }

	ballObj.x +=(ballObj.dx * 10);
	ballObj.y +=(ballObj.dy * 5);
      }
  }

    ballObj.draw = function (context) {
	if (ballObj.img) {
	  ballObj.move();
	  context.drawImage(ballObj.img, ballObj.x, ballObj.y, tennisBall_radius, tennisBall_radius);
	}
    }
  }

  function Random(range) {
	return Math.floor((Math.random() * range) + 1);
  }

  function init() {
	myCanvas = document.getElementById("tennis-court");
	tennisCourt = myCanvas.getContext("2d");

	tennisCourt.clearRect(0, 0, myCanvas.width, myCanvas.height);

	var tc = new TennisCourt();
	
	tc.addObject(tennisRacket);

	ball.x = Random(myCanvas.width - 30);
	ball.y = Random(myCanvas.height - 30);
	ball.dx = Random(1);
	ball.dy = Random(1);
	ball.speed = Random(5) +2;
	tc.addObject(ball);
	
	tc.init();
	myCanvas.focus();

}

function moveRacket (e) {
    var code = e.keyCode;
    
   //alert ("key code=" + code);
    switch(code) {

	case 38:
	  e.preventDefault();
	  tennisRacket.y-= 30;
	  break;

	case 40:
	  e.preventDefault();
	  tennisRacket.y += 30;
	  break;
	
	case 37:
	  e.preventDefault();
	  tennisRacket.x-= 30;
	  break;

	case 39:
	  e.preventDefault();
	  tennisRacket.x += 30;
	  break;

    }
  }


  function checkCollision (rx, ry, rw, rh, bx, by, r) {
    if (bx > rx+rw || rx > bx+r-30) {
	return false;
    }
    
    if (by > ry+rh || ry > by+r) {
	return false;
    }

    return true;
  }


function addPoint() {
    score++;

    if( score == winScore ) {
	document.getElementById("score").value="Win: " + score;
	alert("you WIN!");
	stop();
    }
    else{
	document.getElementById("score").value="Score: "+ score;
    }
  }

function losePoint() {
    score--;

    if( score == loseScore ) {
	document.getElementById("score").value="Lost: " + score;
	alert ("Game Over! You LOST!");
	stop();
    }
    else{
	document.getElementById("score").value="Score: "+ score;
    }
  }


  function draw() {
	myCanvas = document.getElementById("tennis-court");
	tennisCourt = myCanvas.getContext("2d");

	tennisCourt.clearRect(0, 0, myCanvas.width, myCanvas.height);

	var tc = new TennisCourt();

	ball.draw(tennisCourt);		
	tennisRacket.draw(tennisCourt);	//Draw racket

  }

  setTimeout(function() {draw(); ball.move(); } ,500);


  function start() {
	gameover = false;
	score = 0;
	document.getElementById("score").value = "Score: "+ score;

	draw();
	ball.move();

  }

  function stop() {
	gameover = true;

  }

  


</script>

<!DOCTYPE html>
<html>
<head>

<title> Tennis for Lazy People </title>
<link rel="stylesheet" type="text/css" href="Tennis for Lazy People.css"/>

</head>

<body onload="init();" style="margin: 0px">
<center><pre style="font-family:cursive; font-size:50;"> Tennis for Lazy People </pre></center>

<pre style="font-family:cursive; font-size:30; color:blue;">   RULES:</pre>
<pre style="font-family:cursive; font-size:20; color:red;">
	Scoring:   To earn points, hit the left wall. If you hit the right wall you lose points.
	Controls:  Use your up and down arrows to control the racket.
	Objective: Reach 10 points to win. 
	To Lose:   Reach -10 points to lose (try not to).

 <button onclick="start()">Start</button>  <button onclick="stop()">Stop</button> 	Score:<input id="score" style="font-size:30; color:blue; width:120px; float:middle" type="text" value="Score: 0">
 
</pre>

<canvas id="tennis-court" tabindex="0" onkeydown="moveRacket(event)" height="1024" width="585"></canvas>

</body>

</html>

